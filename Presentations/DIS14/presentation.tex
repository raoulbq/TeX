\documentclass{beamer}
\usepackage[english]{babel}
\usepackage{color}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage[utf8x]{inputenc}
\usepackage[version=3]{mhchem}
\input{./header_math.tex}

\mode<presentation>
{
  \usetheme{Montpellier}
  \setbeamercovered{transparent}
}

\synctex=1
\parindent 0pt

\title[Numerical Steepest Descent for Hagedorn Wavepackets]
      {Application of Numerical Steepest Descent \\
       for Overlap Integrals \\
       of Semiclassical Wavepackets}
\author[]{Raoul Bourquin}

\date{Disentis 2014}

\beamertemplatenavigationsymbolsempty
% -----------------------------------------------------------------------------------------
\begin{document}

\begin{frame}
  \titlepage
\end{frame}

\begin{frame}{Outline}
  \tableofcontents
\end{frame}


\section{Motivation}

\begin{frame}{Motivation}
  \begin{itemize}
    \item Simulation of heavy \ce{Hg2}
    \begin{itemize}
      \item Initial value $\ket{\Psi_0}$
      \item Time-propagated value $\ket{\Psi_t}$
    \end{itemize}
  \end{itemize}
  \begin{figure}
    \centering
    \includegraphics[width=0.7\linewidth]{./fig/hg_morse_wps.png}
  \end{figure}
\end{frame}


\begin{frame}{Motivation}
  \begin{itemize}
    \item Compute autocorrelation $|A(t)|$
  \end{itemize}
  \vspace{0.2cm}
  \begin{equation*}
    A(t) \assign \Braket{\Psi_0 | \Psi_t}
         = \idotsint_{\mathbb{R}^D} \conj{\Psi_0(\vec{x})} \Psi_t(\vec{x}) \di{\vec{x}}
  \end{equation*}
  \begin{figure}
    \centering
    \includegraphics[width=0.7\linewidth]{./fig/ac_mercurial_morse.pdf}
  \end{figure}
\end{frame}


\section{Highly Oscillatory Integrals}


\begin{frame}{Highly Oscillatory Integrals}{Typical Example}
  \begin{minipage}{0.5\linewidth}
    \begin{equation*}
      I = \int_{\Omega} f(\vec{x}) e^{\imath \omega g(\vec{x})} \di{\vec{x}}
    \end{equation*}
    \begin{itemize}
      \item Oscillator $g(\vec{x})$ (non-oscillatory)
      \item Envelope $f(\vec{x})$ (non-oscillatory)
      \item Frequency $\omega \in \mathbb{R}^{+}$
      \item Domain $\Omega \subseteq \mathbb{R}^D$
    \end{itemize}
  \end{minipage}
  \begin{minipage}{0.48\linewidth}
    \begin{figure}
      \centering
      \includegraphics[width=\linewidth]{./fig/oscillatory_example.pdf}
    \end{figure}
    \vspace{-0.6cm}
    \begin{align*}
      f(x) & = \frac{1}{1+x^2} \\
      g(x) & = \left(x - \frac{1}{2}\right)^2 \\
      \omega & = 100
    \end{align*}
  \end{minipage}
\end{frame}


\begin{frame}{Highly Oscillatory Integrals}{Typical Example}
  \begin{minipage}{0.5\linewidth}
    Compute:
    \begin{equation*}
      \int_{-2}^3 \int_{-2}^3 \frac{e^{5 \imath \left(x^2-x y-y^2\right)}}{1 + (x+y)^2} \di{x} \di{y}
    \end{equation*}
    where:
    \begin{align*}
      f(x) & = \frac{1}{1 + (x+y)^2} \\
      g(x) & = x^2 - x y - y^2 \\
    \end{align*}
    and $\omega = 5$
  \end{minipage}
  \begin{minipage}{0.48\linewidth}
    \begin{figure}
      \centering
      \includegraphics[width=\linewidth]{./fig/oscillatory_example_2d.png}
    \end{figure}
  \end{minipage}
\end{frame}


\section{The Numerical Steepest Descent Method}


\begin{frame}{Numerical Steepest Descent}{Central observations}
  Oscillatory part $e^{\imath \omega g(x)}$ of:
  \begin{equation*}
    I = \int_a^b f(x) e^{\imath \omega g(x)} \di{x}
  \end{equation*}
  does:
  \begin{itemize}
    \item decay exponentially fast for increasing $\Im g(z)$
    \item not oscillate for constant $\Re g(z)$
  \end{itemize}
  because:
  \begin{equation*}
    e^{\imath \omega g(z)}
    =
    e^{\imath \omega (\Re g(z) + \imath \Im g(z))}
    =
    e^{\imath \omega \Re g(z)}
    e^{- \omega \Im g(z)}
  \end{equation*}
\end{frame}


\begin{frame}{Numerical Steepest Descent}{Main Idea and overview}
  \begin{itemize}
    \item Transform the integrand such that it is no longer oscillatory but rather exponentially decaying.
  \end{itemize}
  \vspace{1cm}
  \begin{itemize}
    \item Find a coordinate transformation $z = h(\tau)$ such that the \emph{real} part
          of $g(z)$ is constant.
    \item Apply Cauchy's Theorem for contour integrals along $h(\tau)$.
  \end{itemize}
\end{frame}


\begin{frame}{Numerical Steepest Descent}{Contributions to the integral}
  \begin{minipage}{0.6\linewidth}
    Which parts do contribute?
    \begin{itemize}
      \item Endpoints of the interval: $[a, b]$
      \item \emph{stationary points}: $\nabla g(\vec{x}) = \vec{0}$
      \item \emph{resonance points}: $\nabla_x \, g(\vec{x}) \perp \partial \Omega$
    \end{itemize}
  \end{minipage}
  \begin{minipage}{0.38\linewidth}
    \begin{figure}
      \centering
      \includegraphics[width=\linewidth]{./fig/oscillatory_example_2.pdf}
    \end{figure}
  \end{minipage}
  Intuitive explanation:
  \begin{itemize}
    \item Oscillations in integrand generally cancel
    \item Places with locally no oscillations contribute
  \end{itemize}
\end{frame}


\begin{frame}{Numerical Steepest Descent}{The Path Equation}
  \begin{minipage}{0.58\linewidth}
    \begin{itemize}
      \item Set of contributing points:
      \begin{equation*}
        \Xi := \{a, b\} \cup \{x^{*}_j\}_j
      \end{equation*}
    \end{itemize}
    \begin{itemize}
      \item Path equations:
      \begin{itemize}
        \item $\forall \xi \in \Xi$:
        \begin{equation*}
          g(h_\xi(\tau)) = g(\xi) + \imath \tau
        \end{equation*}
        \item yields path $h_{\xi}(\tau)$ with $\tau \in \mathbb{R}_0^{+}$
      \end{itemize}
    \end{itemize}
  \end{minipage}
  \begin{minipage}{0.40\linewidth}
    \begin{figure}
      \centering
      \includegraphics[width=\linewidth]{./fig/nsd_path_figure.pdf}
    \end{figure}
  \end{minipage}
\end{frame}


\begin{frame}{Numerical Steepest Descent}{Solving the Path Equation}
  \begin{minipage}{0.58\linewidth}
    \begin{itemize}
      \item Endpoints:
        \begin{itemize}
          \item unique inverse of $g$
          \item compute $h_a$ and $h_b$:
          \begin{equation*}
            h_a(0) = a \quad \wedge \quad h_b(0) = b
          \end{equation*}
        \end{itemize}
      \item Stationary points:
        \begin{itemize}
          \item multivalued inverse of $g$
          \item paths lead to the same \emph{valley}
        \end{itemize}
        % TODO: Go into more details?
    \end{itemize}
  \end{minipage}
  \begin{minipage}{0.40\linewidth}
    \begin{figure}
      \centering
      \includegraphics[width=\linewidth]{./fig/nsd_path_figure.pdf}
    \end{figure}
  \end{minipage}
\end{frame}


\begin{frame}{Numerical Steepest Descent}{Assemble the parts}
  \begin{itemize}
    \item Perform transformations $x \mapsto h_{\xi}(\tau)$
    \begin{equation*}
      J[\xi] :=
      e^{\imath \omega g(\xi)}
      \int_{0}^{\infty}
        f(h_{\xi}(\tau)) \,
        h_{\xi}^{\prime}(\tau) \,
        e^{-\omega \tau} \,
      \mathrm{d}\tau
    \end{equation*}
    \item Apply Cauchy's Theorem
    \begin{equation*}
      I = e^{\imath\omega g(a)} J[a]
        + \sum_{j} \left(J[x_{j,+}^{*}] - J[x_{j,-}^{*}]\right)
        - e^{\imath\omega g(b)} J[b]
    \end{equation*}
    \item Restrictions about poles and branch cuts
    \item Just transformation of the problem
  \end{itemize}
\end{frame}


\begin{frame}{Numerical Steepest Descent}{Quadrature}
  \begin{itemize}
    \item New problem compute:
    \begin{equation*}
      J[\xi] :=
      e^{\imath \omega g(\xi)}
      \int_{0}^{\infty}
        f(h_{\xi}(\tau)) \,
        h_{\xi}^{\prime}(\tau) \,
        e^{-\omega \tau} \,
      \mathrm{d}\tau
    \end{equation*}
    \item Gauss-Laguerre quadrature $\{\gamma_i, \omega_i\}_i$
    \begin{equation*}
    J[\xi] \approx
    \frac{e^{\imath \omega g(\xi)}}{\omega}
    \sum_{k=1}^K
      f\left(h_{\xi}\left(\frac{\gamma_i}{\omega}\right)\right)
      h_{\xi}^{\prime}\left(\frac{\gamma_i}{\omega}\right)
      w_i
    \end{equation*}
    \item Number of integrals can grow exponentially
    \item Important improvements possible
  \end{itemize}
\end{frame}


\begin{frame}{Numerical Steepest Descent}{Main decomposition theorem}
  \begin{theorem}
    Assume that the functions $f$ and $g$ are analytic in a simply connected and
    sufficiently (infinitely) large complex region $D$ containing the interval $[a, b]$.
    Assume further that the equation $g(x) = 0$ has only one solution $x^{*}$ in $D$ and
    $x^{*} \in (a, b)$. Define $g_1 \assign g|_{[a,x^{*}]}$ and $g_2\assign g|_{[x^{*},b]}$.
    If the following conditions hold:
    \begin{align*}
      \exists m \in \mathbb{N} : |f(z)| & = \mathcal{O}(|z|^m), \\
      \exists \omega_0 \in \mathbb{R} : |g_1^{-1}(z)| & = \mathcal{O}(e^{\omega_0 |z|}) \\
                                        |g_2^{-1}(z)| & = \mathcal{O}(e^{\omega_0 |z|})
    \end{align*}
    as $|z| \rightarrow \infty$ then
  \end{theorem}
\end{frame}


\begin{frame}{Numerical Steepest Descent}{Main decomposition theorem, continued}
  \begin{theorem}
    there exist functions $F_j(\xi), j = 1, 2$ of the form:
    \begin{equation*}
      F_j(\xi) \assign \int_{\Gamma_{\xi,j}} f(z) e^{\imath \omega g(z)} \di{z}
    \end{equation*}
    with $\Gamma_{\xi,j}$ a path that starts at $\xi$, such that:
    \begin{equation*}
      \int_s^t f(z) e^{\imath \omega g(z)} \di{z} =
      F_1(s) - F_1(x^{*}) + F_2(x^{*}) - F_2(t), \quad \forall \omega > (m+1)\omega_0,
    \end{equation*}
    for $s \in [a, x^{*}]$ and $t \in [x^{*}, b]$. A parameterization
    $h_{\xi,j}(\tau)$, $\tau \in [0, \infty)$, for $\Gamma_{\xi,j}$ exists such that
    the integrand of $F_{j}$ is $\mathcal{O}(e^{âˆ’\omega \tau})$.
  \end{theorem}
\end{frame}


\begin{frame}{Numerical Steepest Descent}{Extensions and Outlook}
  This was for closed intervals. What about:
  \vspace{0.2cm}
  \begin{itemize}
    \item semi-open intervals $[a, \infty)$?
    \begin{itemize}
      \item Works the same (no proofs yet)
    \end{itemize}
    \item infinite intervals $(-\infty, \infty)$?
    \begin{itemize}
      \item Decompose into two semi-open intervals
    \end{itemize}
    \item Multiple stationary points?
    \begin{itemize}
      \item Apply procedure at each $x^{*}_i$
    \end{itemize}
    \item Complex stationary points $x^{*} \in \mathbb{C} \setminus \mathbb{R}$?
    \begin{itemize}
      \item Put path through the point
    \end{itemize}
    \item Higher dimensions?
    \begin{itemize}
      \item Much more involved and complicated theory
    \end{itemize}
  \end{itemize}
\end{frame}


\begin{frame}{Numerical Steepest Descent}{Example $g(x) := x^2$}
  \begin{equation*}
    I = \int_{-1}^{1} 1 e^{\imath \omega x^2} \di{x}
    \quad \text{with} \quad
    g(x) \assign x^2
  \end{equation*}
  \begin{equation*}
    g^{\prime}(x) = 0 \quad \Rightarrow \quad x^{*} = 0
  \end{equation*}
  \begin{equation*}
    \begin{split}
    g(h_{-1}) = g(-1) + \imath \tau   & \Rightarrow
    h_{-1}(\tau) = -\sqrt{1+\imath\tau}, \quad
    h_{-1}^{\prime}(\tau) = -\frac{\imath}{2\sqrt{1+\imath\tau}} \\
    g(h_{1}) = g(1) + \imath \tau   & \Rightarrow
    h_{1}(\tau) = \sqrt{1+\imath\tau}, \quad
    h_{-1}^{\prime}(\tau) = \frac{\imath}{2\sqrt{1+\imath\tau}} \\
    g(h_{0}) = g(0) + \imath \tau   & \Rightarrow
    h_{0,\pm}(\tau) = \pm\imath\tau, \quad
    h_{0,\pm}^{\prime}(\tau) = \pm\imath
        \end{split}
  \end{equation*}
  \begin{equation*}
    \begin{split}
    I = e^{\imath\omega} \int_0^\infty h_{-1}^{\prime}(\tau) e^{-\omega\tau} \di{\tau}
    - \int_0^\infty h_{0,-}^{\prime}(\tau) e^{-\omega\tau} \di{\tau} \\
    + \int_0^\infty h_{0,+}^{\prime}(\tau) e^{+\omega\tau} \di{\tau}
    - e^{\imath\omega} \int_0^\infty h_{1}^{\prime}(\tau) e^{-\omega\tau} \di{\tau}
    \end{split}
  \end{equation*}
\end{frame}


\begin{frame}{Numerical Steepest Descent}{Complex Stationary Points}
  \vspace{-0.5cm}
  \begin{equation*}
    \int_{-2}^{2} \log(2+x^2) e^{50 \imath \left(\delta x + \frac{x^3}{3}\right)} \di{x}
  \end{equation*}
  with $\delta = [10, 5, 2, 1, \frac{1}{2}, \frac{1}{5}, \frac{1}{10}, \frac{1}{100}, 0]$
  and $x^{*} = \pm \imath \sqrt{\delta}$
  \begin{figure}
    \centering
    \includegraphics[width=0.7\linewidth]{./fig/oscillatory_integral_complex_sp.pdf}
  \end{figure}
\end{frame}


\begin{frame}{Numerical Steepest Descent}{Semi-open Intervals}
  \begin{minipage}{0.5\linewidth}
    \begin{equation*}
      I = \int_0^\infty \frac{100}{100 + x^2} \exp(\imath \omega e^{\sqrt{x}}) \di{x}
    \end{equation*}
    with $\omega = 2$
    \begin{figure}
      \centering
      \includegraphics[width=\linewidth]{./fig/oscillatory_example_semiopen.pdf}
    \end{figure}
  \end{minipage}
  \begin{minipage}{0.48\linewidth}
    \begin{equation*}
      h_a(\tau) = \log(1 + \imath\tau)^2
    \end{equation*}
    \begin{figure}
      \centering
      \includegraphics[width=0.6\linewidth]{./fig/nsd_path_semiopen_figure.pdf}
    \end{figure}
    \begin{equation*}
      I = e^{\imath\omega} \int_0^{\infty} \frac{100 e^{-\omega\tau}}{100+\log(1+\imath\tau)} \di{\tau}
    \end{equation*}
  \end{minipage}
\end{frame}


\begin{frame}{Numerical Steepest Descent}{Literature}
  \cite{AH_cgq}
  \cite{HV_hoq}
  \cite{HV_cub}
  \cite{H_nsd_sii}
  \scriptsize
  \bibliographystyle{abbrv}
  \bibliography{nsd}
\end{frame}


\section{Hagedorn Wavepackets}
\subsection{Definition}


\begin{frame}{Semiclassical Wavepackets}
  \begin{figure}
    \centering
    \includegraphics[width=\linewidth]{./fig/wavepackets.pdf}
  \end{figure}
\end{frame}

\begin{frame}{Semiclassical Wavepackets}
  \begin{figure}
    \centering
    \includegraphics[width=\linewidth]{./fig/wavepackets_2d.png}
  \end{figure}
\end{frame}

\begin{frame}{Semiclassical Wavepackets}{Definition}
  $\phi_0$
\end{frame}


\begin{frame}{Semiclassical Wavepackets}{Raising and Lowering Operators}
  $\mathcal{R}$ and $\mathcal{L}$
\end{frame}



% Usual definition of phi_0
% Ladder Operators
% Do all in 1D

\subsection{Inner products}

% Will give exactly the necessary form


\subsection{Applying NSD to HAWPs}
\subsubsection{Technical Difficulties}

% Example in 1D


\subsection{Examples}

% Testcase with momentum-collision



\subsection{Higher Dimensions}

% Formal procedure
% Merging Wavepackets
% Ugly Properties of the Matrix
% Schur Decomposition
% Oscillator Updates
% Merging Paths




\section{Quadrature Schemes}

\begin{frame}{Quadrature Schemes}
  \begin{itemize}
  \item Problem:
    \begin{itemize}
    \item still full tensorproduct quadrature
    \item fewer nodes per direction
    \item
    \end{itemize}
  \end{itemize}
  \vspace{0.2cm}
  \begin{itemize}
  \item Solution:
    \begin{itemize}
    \item sparse grid schemes
    \item Smolyak rule
    \end{itemize}
  \end{itemize}
\end{frame}




\subsection{Smolyak Quadrature Schemes}

% Gauss Nodes not nested
% Smolyak in this form useless even harmful

\begin{frame}{Smolyak construction issues}
  \begin{itemize}
    \item Problem:
    \begin{itemize}
      \item Gauss-Hermite points not nested
      \item more points than full tensorproduct
    \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}{Smolyak construction issues}
  Construction with Gauss-Hermite rules
  \begin{figure}
    \centering
    \includegraphics[width=0.8\linewidth]{./fig/smolyak_gauss_ratiomap.png}
  \end{figure}
\end{frame}

\begin{frame}{Smolyak construction issues}
  \begin{itemize}
    \item Solution:
    \begin{itemize}
      \item Search rules with nested nodes
      \item For interval $(-\infty, \infty)$ with weights $\exp(-x^2)$
      \item Iterative \emph{Kronrod} extensions
    \end{itemize}
  \end{itemize}
\end{frame}


\subsection{Kronrod Extension Schemes}

\begin{frame}{Kronrod Extensions}
  \begin{itemize}
    \item Goal: Find nested quadrature rules
    \item How?
  \end{itemize}
\end{frame}


\subsection{Genz-Keister Rules}


\begin{frame}{Smolyak construction}{Genz-Keister Nodes}
  \begin{figure}
    \centering
    \includegraphics[width=\linewidth]{./fig/genz_keister_nodes.png}
  \end{figure}
\end{frame}

\begin{frame}{Smolyak construction}
  Construction with Genz-Keister nested rules
  \begin{figure}
    \centering
    \includegraphics[width=0.8\linewidth]{./fig/smolyak_genzkeister_ratiomap.png}
  \end{figure}
\end{frame}


\begin{frame}{Final Solution for computing overlap Integrals}
  \begin{itemize}
    \item Chain of \emph{transformators}
    \begin{itemize}
      \item Steepest Descent: remove oscillations
      \item Sparse Grid: lessen curse of dimensionality
      \item Genz-Keister rules: nodes are nested
    \end{itemize}
  \end{itemize}
  \begin{figure}
    \centering
    \includegraphics[width=\linewidth]{./fig/diagram4.pdf}
  \end{figure}
\end{frame}



\section{Examples}

% Morse going wrong
% Harmonic Channel
% Harmonic Tube



\section{Future Work}

\begin{frame}
  \begin{itemize}
    \item Proof the steepest descent technique for unbounded intervals
    \item Other integrals like $\braket{\phi|V|\phi}$
    \item Potentials with exponential parts
    \item Proof for Kronrod Extensions
    \item Search for optimal rule
  \end{itemize}
\end{frame}


\section{End}

\begin{frame}{Thanks for your attention}
  \begin{center}
    {\Huge{Questions?}}
  \end{center}
\end{frame}

\end{document}
